/**
 * Hai Form (https://github.com/safraja/hai-form) - Javascript library for custom inputs and selects with additional functions.
 * Copyright (c) 2021 Jakub Šafránek All Rights Reserved
 * @license MIT Licensed
 */
import{_ as e,a as t,c as a,b as i,f as s,g as r,HaiInput as l}from"./hai-input-class.esm.min.js";import{HaiInputText as n}from"./hai-input-text-class.esm.min.js";import"./en.esm.min.js";var u=function(u){e(h,n);var o=t(h);function h(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(this,h),(e=o.call(this,t,i)).min=null,e.max=null,e.step=1,e.stripLeadingZeros=!0,e.decimalSeparator=",",e.delimiter=" ",e.thousandsGroupStyle="thousand",e.enableValueFormation=!0,e.maxDecimalDigitsCount=null,e.type="number",e}return i(h,[{key:"processParameters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===e&&(e=this.parameters),s(r(h.prototype),"processParameters",this).call(this,e),void 0!==e.min&&(!0===isNaN(e.min)?console.warn('HaiForm: Parameter "min" must be a number.'):this.min=e.min),void 0!==e.max&&(!0===isNaN(e.max)?console.warn('HaiForm: Parameter "max" must be a number.'):this.max=e.max),void 0!==e.step&&(!0===isNaN(e.step)?console.warn('HaiForm: Parameter "step" must be a number, reverting back to "1".'):this.step=e.step),void 0!==e.stripLeadingZeros&&(this.stripLeadingZeros=Boolean(e.stripLeadingZeros)),void 0!==e.decimalSeparator&&(this.decimalSeparator=e.decimalSeparator),void 0!==e.delimiter&&(this.delimiter=e.delimiter),void 0!==e.thousandsGroupStyle){var t=["thousand","lakh","wan"];!1===t.includes(e.thousandsGroupStyle)?console.warn('HaiForm: Given thousands group style is not supported, reverting back to "thousand". Supported types are:',t):this.thousandsGroupStyle=e.thousandsGroupStyle}void 0!==e.enableValueFormation&&(this.enableValueFormation=Boolean(e.enableValueFormation)),void 0!==e.maxDecimalDigitsCount&&(!0===isNaN(e.maxDecimalDigitsCount)?console.warn('HaiForm: Parameter "maxDecimalDigitsCount" must be a number, reverting back to null.'):this.maxDecimalDigitsCount=e.maxDecimalDigitsCount)}},{key:"handleInput",value:function(e){if(this.readonly||this.disabled)return e.target.value=this.value,{success:!1};var t=e.target.value,a=this.value,i=e.target.selectionEnd,s=this.extractRawValue(t);!1===isNaN(s)&&null!==this.maxDecimalDigitsCount&&(s=this.truncateDecimals(s,this.maxDecimalDigitsCount)),this.rawValue=s;var r=this.formatValue(s);this.value=r,e.target.value=r,this.saveValueToTwin();var l=this.getNextCursorPosition(i,a,r,e);return e.target.setSelectionRange(l,l),{success:!0}}},{key:"truncateDecimals",value:function(e,t){var a,i=e.toString(),s=i.indexOf(".");return a=-1===s?i.length:1+s+t,i.substr(0,a)}},{key:"extractRawValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===e&&(e=this.value),e.replace(/[A-Za-z]/g,"").replace(/[.,٫]/,"M").replace(/[^\dM-]/g,"").replace(/^\-/,"N").replace(/\-/g,"").replace("N","-").replace("M",".")}},{key:"formatValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t="";if(null===e&&(e=this.rawValue),""===(e=String(e))||"-"===e||"+"===e)return e;if(this.enableValueFormation){var a;"-"!==e.slice(0,1)&&"+"!==e.slice(0,1)||(a=e.slice(0,1));var i=(e=e.replace(/[+-]/,"")).split("."),s=null,r=i[0];this.stripLeadingZeros&&(r=r.replace(/^0+/g,"")),""===r&&(r="0"),null!=i[1]&&""!==i[1]&&(s=i[1]),"-"===a&&(t+=a),t+=r=this.applyGroupStyle(r),null!=i[1]&&(t+=this.decimalSeparator),null!==s&&(t+=s)}else t=e;return t}},{key:"checkValidity",value:function(){var e=s(r(h.prototype),"checkValidity",this).call(this);return!1===e.success?e:!0===isNaN(this.rawValue)?{success:!1,message:l.dictionary["value-must-be-a-number"]}:null!==this.max&&Number(this.rawValue)>this.max?{success:!1,message:l.dictionary["max-value-exceeded"].replace("{{max}}",this.max)}:null!==this.min&&Number(this.rawValue)<this.min?{success:!1,message:l.dictionary["min-value-exceeded"].replace("{{min}}",this.min)}:{success:!0}}},{key:"applyGroupStyle",value:function(e){switch(this.thousandsGroupStyle){case"thousand":e=e.replace(/(\d)(?=(\d{3})+$)/g,"$1"+this.delimiter);break;case"lakh":e=e.replace(/(\d)(?=(\d\d)+\d$)/g,"$1"+this.delimiter);break;case"wan":e=e.replace(/(\d)(?=(\d{4})+$)/g,"$1"+this.delimiter)}return e}},{key:"getNextCursorPosition",value:function(e,t,a,i){if(t.length===e-1||"insertFromPaste"===i.inputType)return a.length;var s=this.extractRawValue(t),r=this.extractRawValue(a);return"deleteContentForward"===i.inputType&&s===r?e+1:e+this.getPositionOffset(e,t,a)}},{key:"getPositionOffset",value:function(e,t,a){var i,s,r;return i=this.extractRawValue(t.slice(0,e)),s=this.extractRawValue(a.slice(0,e)),0!==(r=i.length-s.length)?r/Math.abs(r):0}},{key:"changeNumberValue",value:function(e){var t=Number(this.rawValue);isNaN(t)&&(t=0);var a=t+Number(e);if(!(e>0&&null!==this.max&&a>this.max||e<0&&null!==this.min&&a<this.min)){e<0&&null!==this.max&&a>this.max&&(a=this.max),e>0&&null!==this.min&&a<this.min&&(a=this.min),this.rawValue=String(a);var i=this.formatValue(this.rawValue);this.value=String(i),this.saveValueToTwin()}}},{key:"handleKeyAction",value:function(e){if(!this.readonly&&!this.disabled&&!1===this.verifyEnterKey(e))switch(e.code){case"ArrowUp":e.preventDefault(),this.changeNumberValue(Number(this.step)),e.target.value=this.value;break;case"ArrowDown":e.preventDefault(),this.changeNumberValue(-1*Number(this.step)),e.target.value=this.value}}},{key:"handleWheel",value:function(e){e.preventDefault(),this.readonly||this.disabled||(e.deltaY<0?this.changeNumberValue(Number(this.step)):this.changeNumberValue(-1*Number(this.step)),e.target.value=this.value)}}]),h}();export{u as HaiInputNumber};
