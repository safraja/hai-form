/**
 * Hai Form (https://github.com/safraja/hai-form) - Javascript library for custom inputs and selects with additional functions.
 * Copyright (c) 2021 Jakub Šafránek All Rights Reserved
 * @license MIT Licensed
 */
import{_ as t,a as e,c as a,b as n,f as i,g as s,d as o,HaiInput as l,h as r,i as u}from"./hai-input-class.esm.min.js";import"./en.esm.min.js";var h=function(h){t(p,l);var c,d=e(p);function p(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(this,p),(t=d.call(this,e,n)).options=["","on"],t.variant="on/off",t.orientation="horizontal",t.optionOnValue=null,t.inputs=[],t.type="switch",t}return n(p,[{key:"transformElementToHaiInput",value:(c=r(u().mark((function t(){var e,a,n,i,s,l,r,h,c,d,p,v,f,m,y,b,g=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.element.name,this.value=this.element.value,this.rawValue=this.value,a=document.createElement("input"),void 0!==e&&(this.element.removeAttribute("name"),a.name=e),a.type="text",a.hidden=!0,a.classList.add("hidden"),a.value=this.rawValue,t.next=11,this.processAttributes();case 11:return t.next=13,this.processParameters();case 13:if(this.convertOptionsToObjectArray(),this.disabled&&(a.disabled=!0),!(this.options.length<2)){t.next=18;break}return console.error("There must be at least 2 options specified."),t.abrupt("return");case 18:"on/off"===this.variant&&(this.options.length>2?(this.variant="multiple",console.warn('Variant "on/off" is not usable with more then 2 specified options, reverting to "multiple" variant.')):null===this.optionOnValue?this.optionOnValue=this.options[this.options.length-1].value:this.options[0].value===this.optionOnValue&&(this.options=this.options.reverse())),(n=document.createElement("div")).classList.add("hai-input-element"),n.classList.add("switch"),(i=document.createElement("div")).classList.add("label-text"),(s=document.createElement("div")).classList.add("alert"),(l=document.createElement("div")).classList.add("switch-wrapper"),"on/off"===this.variant?(l.setAttribute("data-variant","on/off"),null!==this.optionOnValue&&this.rawValue===String(this.optionOnValue)?l.setAttribute("data-state","on"):l.setAttribute("data-state","off")):"vertical"===this.orientation&&l.classList.add("vertical"),!0!==this.disabled&&!0!==this.readonly||l.classList.add("inactive"),(r=document.createElement("div")).classList.add("option-group"),l.appendChild(r),"on/off"===this.variant&&((h=document.createElement("span")).classList.add("toggle"),r.appendChild(h)),c=o(this.options);try{for(c.s();!(d=c.n()).done;)p=d.value,(v=document.createElement("label")).classList.add("option"),(f=document.createElement("input")).type="radio",f.value=p.value,this.inputs.push(f),this.value===p.value&&(f.checked=!0,"multiple"===this.variant&&v.classList.add("selected")),m=document.createElement("span"),null!==p.label&&(m.textContent=p.label),v.append(f,m),r.appendChild(v)}catch(t){c.e(t)}finally{c.f()}n.append(i,l,s),this.element.after(n),this.element.remove(),this.element=l,this.element.haiInput=this,y=Math.floor(99999999*Math.random()+1),a.id="input-".concat(y),this.element.parentElement.appendChild(a),this.twin=a,this.labelElement=i,this.warningElement=s,void 0!==this.label&&(this.labelElement.textContent=this.label),this.element.querySelector(".option-group").addEventListener("click",(function(t){g.handleInput(t)})),null!==(b=a.form)&&b.addEventListener("submit",(function(t){return!1!==g.checkValidity().success||(t.preventDefault(),!1)}));case 53:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"processParameters",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===t&&(t=this.parameters),i(s(p.prototype),"processParameters",this).call(this,t),void 0!==t.optionOnValue&&("string"!=typeof t.optionOnValue?console.warn('HaiForm: Parameter "optionOnValue" must by a string containing value of one of options.'):this.optionOnValue=t.optionOnValue),void 0!==t.list)if("string"!=typeof t.list)console.warn("HaiForm: List parameter must by a string.");else{var e=document.getElementById(t.list);if(null===e)console.warn("HaiForm: Datalist with id ".concat(t.list," was not found."));else{var a=e.querySelectorAll("option");this.options=[];var n,l=o(a);try{for(l.s();!(n=l.n()).done;){var r=n.value;this.options.push({label:r.textContent,value:r.getAttribute("value")})}}catch(t){l.e(t)}finally{l.f()}}}void 0!==t.variant&&(!1===["on/off","multiple"].includes(t.variant)?console.warn('HaiForm: Parameter "variant" can be either "on/off" or "multiple", reverting back to default.'):this.variant=t.variant),void 0!==t.orientation&&(!1===["horizontal","vertical"].includes(t.orientation)?console.warn('HaiForm: Parameter "orientation" can be either "horizontal" or "vertical", reverting back to default.'):this.orientation=t.orientation),void 0!==t.options&&(this.options=t.options)}},{key:"convertOptionsToObjectArray",value:function(){var t=this.options;if("string"==typeof t&&(t=JSON.parse(t)),Array.isArray(t)&&t.length>0&&"string"==typeof t[0]){var e,a=[],n=o(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;a.push({value:i})}}catch(t){n.e(t)}finally{n.f()}t=a}this.options=t}},{key:"handleInput",value:function(t){return this.readonly||this.disabled?{success:!1}:"on/off"===this.variant?this.handleInputOfOnOffVariant(t):this.handleInputOfMultipleVariant(t)}},{key:"handleInputOfMultipleVariant",value:function(t){t.preventDefault();var e=t.target;!1===e.matches(".option")&&(e=e.closest(".option"));var a,n=o(this.inputs);try{for(n.s();!(a=n.n()).done;){var i=a.value;i.checked=!1,i.parentElement.classList.remove("selected")}}catch(t){n.e(t)}finally{n.f()}var s=e.querySelector("input");return s.checked=!0,this.value=s.value,this.rawValue=s.value,e.classList.add("selected"),this.saveValueToTwin(),{success:!0}}},{key:"handleInputOfOnOffVariant",value:function(t){var e;t.preventDefault();var a,n=o(this.options);try{for(n.s();!(a=n.n()).done;){var i=a.value;this.rawValue!==i.value&&(e=i.value)}}catch(t){n.e(t)}finally{n.f()}var s,l=o(this.inputs);try{for(l.s();!(s=l.n()).done;){var r=s.value;e!==r.value?r.checked=!1:r.checked=!0}}catch(t){l.e(t)}finally{l.f()}return this.value=e,this.rawValue=e,null!==this.element&&(this.rawValue===this.optionOnValue?this.element.setAttribute("data-state","on"):this.element.setAttribute("data-state","off")),this.saveValueToTwin(),{success:!0}}}]),p}();export{h as HaiInputSwitch};
