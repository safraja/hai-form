/**
 * Hai Form (https://github.com/safraja/hai-form) - Javascript library for custom inputs and selects with additional functions.
 * Copyright (c) 2021 Jakub Šafránek All Rights Reserved
 * @license MIT Licensed
 */
import{_ as e,a,c as t,b as r,f as s,g as l,d as i,j as o,HaiInput as n}from"./hai-input-class.esm.min.js";import{HaiInputText as u}from"./hai-input-text-class.esm.min.js";import"./en.esm.min.js";var c=function(c){e(d,u);var h=a(d);function d(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(this,d),(e=h.call(this,a,r)).allowedSchemes=["http","https"],e.defaultScheme="http",e.requireHost=!0,e.allowPart={userInfo:!1,port:!1,path:!0,query:!0,fragment:!1},e.stripPart={query:!1,fragment:!0},e.type="url",e}return r(d,[{key:"processParameters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===e&&(e=this.parameters),s(l(d.prototype),"processParameters",this).call(this,e),void 0!==e.allowedSchemes)if(!0!==Array.isArray(e.allowedSchemes)&&null!==e.allowedSchemes&&console.warn('HaiForm: Parameter "allowedSchemes" must by an array or null.'),null===e.allowedSchemes)this.allowedSchemes=e.allowedSchemes;else{var a,t=!0,r=i(e.allowedSchemes);try{for(r.s();!(a=r.n()).done;){var n=a.value;if("string"!=typeof n){t=!1;break}}}catch(e){r.e(e)}finally{r.f()}!1===t?console.warn('HaiForm: Parameter "allowedSchemes" must by an array of strings, item of another type found.'):this.allowedSchemes=e.allowedSchemes}void 0!==e.defaultScheme&&("string"!=typeof e.defaultScheme&&null!==e.defaultScheme?console.warn('HaiForm: Parameter "defaultScheme" must by a string or null.'):this.defaultScheme=e.defaultScheme),void 0!==e.requireHost&&(this.requireHost=Boolean(e.requireHost)),void 0!==e.allowPart&&("object"!==o(e.allowPart)?console.warn('HaiForm: Parameter "allowPart" must by an object.'):(void 0!==e.allowPart.userInfo&&(this.allowPart.userInfo=Boolean(e.allowPart.userInfo)),void 0!==e.allowPart.port&&(this.allowPart.port=Boolean(e.allowPart.port)),void 0!==e.allowPart.path&&(this.allowPart.path=Boolean(e.allowPart.path)),void 0!==e.allowPart.query&&(this.allowPart.query=Boolean(e.allowPart.query)),void 0!==e.allowPart.fragment&&(this.allowPart.fragment=Boolean(e.allowPart.fragment)))),void 0!==e.stripPart&&("object"!==o(e.stripPart)?console.warn('HaiForm: Parameter "stripPart" must by an object.'):(void 0!==e.stripPart.query&&(this.stripPart.query=Boolean(e.stripPart.query)),void 0!==e.stripPart.fragment&&(this.stripPart.fragment=Boolean(e.stripPart.fragment))))}},{key:"handleInput",value:function(e){if(this.readonly||this.disabled)return e.target.value=this.value,{success:!1};var a=e.target.value;return null!=this.mask&&(a=this.formatValueByMask(a)),this.value=a,this.rawValue=a,this.saveValueToTwin(),{success:!0}}},{key:"formatValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===e&&(e=this.rawValue),""===(e=(e=String(e)).trim())||(""!==this.defaultScheme&&null!==this.defaultScheme&&(e=this.appendDefaultScheme(e)),!0===this.stripPart.fragment&&(e=e.replace(/#.*/i,"")),!0===this.stripPart.query&&(e=e.replace(/\?[^#]*/i,""))),e}},{key:"appendDefaultScheme",value:function(e){return/^[a-zA-z0-9.+-]+:\/\//i.test(e)?e:e.startsWith("://")?this.defaultScheme+String(e):e.startsWith("//")?this.defaultScheme+":"+String(e):!1===e.includes(":")||1===(e.match(/:/g)||[]).length&&!0===/[^:]+?:((\d)+$|(\d+\/.*))/gi.test(e)?this.defaultScheme+"://"+String(e):e}},{key:"checkValidity",value:function(){var e=s(l(d.prototype),"checkValidity",this).call(this);if(!1===e.success)return e;if(""===String(this.rawValue))return{success:!0};var a=!1;if(null!==this.allowedSchemes){var t,r=i(this.allowedSchemes);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(this.rawValue.startsWith(String(o)+":")){a=!0;break}}}catch(e){r.e(e)}finally{r.f()}}else a=!0;if(!1===a)return{success:!1,message:n.dictionary["not-allowed-scheme"]};var u,c,h,m,f,p,w,v,y=this.rawValue.replace(/.*?:/i,""),g=y.replace(/.*?(\/\/)/i,"");return!1===y.startsWith("//")?(u=y,c=""):(c=g.replace(/\/.*/i,""),u=g.replace(/.*?\//i,"")),""!==c&&(h=!1===c.includes("@")?"":c.replace(/@.*/i,""),f=!1===c.includes(":")?"":c.replace(/.*?:/i,""),m=(m=c.replace(h+"@","")).replace(":"+f,"")),v=!0===u.includes("#")?u.replace(/.*?#/i,""):"",w=!0===u.includes("?")?(w=u.replace(/#.*/i,"")).replace(/.*?\?/i,""):"",p=(p=u.replace(/#.*/i,"")).replace(/\?.*/i,""),this.requireHost&&""===m?{success:!1,message:n.dictionary["host-required"]}:!1===this.allowPart.userInfo&&""!==h?{success:!1,message:n.dictionary["userinfo-forbidden"]}:!1===this.allowPart.port&&""!==f?{success:!1,message:n.dictionary["port-forbidden"]}:!1===this.allowPart.path&&""!==p?{success:!1,message:n.dictionary["path-forbidden"]}:!1===this.allowPart.query&&""!==w?{success:!1,message:n.dictionary["query-forbidden"]}:!1===this.allowPart.fragment&&""!==v?{success:!1,message:n.dictionary["fragment-forbidden"]}:{success:!0}}},{key:"handleFocusOut",value:function(e){var a=this.formatValue(this.rawValue);this.value=a,this.rawValue=a,e.target.value=a,this.saveValueToTwin();var t=this.checkValidity();!1===t.success?(e.target.classList.add("invalid"),e.target.setCustomValidity(t.message),!0===this.displayValidityWarnings&&void 0!==this.warningElement&&(this.warningElement.textContent=t.message)):(e.target.classList.remove("invalid"),e.target.setCustomValidity(""),void 0!==this.warningElement&&(this.warningElement.textContent=""))}}]),d}();export{c as HaiInputUrl};
