/**
 * Hai Form (https://github.com/safraja/hai-form) - Javascript library for custom inputs and selects with additional functions.
 * Copyright (c) 2021 Jakub Šafránek All Rights Reserved
 * @license MIT Licensed
 */
import{_ as e,a as t,c as n,b as a,f as s,g as i,j as l,HaiInput as r,h,i as o}from"./hai-input-class.esm.min.js";import"./en.esm.min.js";var u=function(u){e(d,r);var m,c=t(d);function d(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n(this,d),(e=c.call(this,t,a)).maxLength=null,e.minLength=null,e.mask=null,e.maskTokens=null,e.placeholder=null,e.buttonSettings=null,e.type="text",e}return a(d,[{key:"transformElementToHaiInput",value:(m=h(o().mark((function e(){var t,n,a,s,i,l,r,h,u,m=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.element.name,this.element.removeAttribute("name"),this.element.type="text",this.element.haiInput=this,this.rawValue=this.extractRawValue(this.element.value),this.element.value=this.rawValue,this.value=this.formatValue(this.rawValue),(n=document.createElement("input")).name=t,n.type="text",n.hidden=!0,n.classList.add("hidden"),n.value=this.element.value,a=Math.floor(99999999*Math.random()+1),n.id="input-".concat(a),(s=document.createElement("div")).classList.add("hai-input-element"),i=document.createElement("label"),(l=document.createElement("div")).classList.add("label-text"),(r=document.createElement("div")).classList.add("input-wrapper"),(h=document.createElement("div")).classList.add("alert"),s.append(i,n),this.element.parentElement.insertBefore(s,this.element),r.appendChild(this.element),i.append(l,r,h),this.twin=n,this.labelElement=l,this.warningElement=h,e.next=35,this.processAttributes();case 35:return e.next=37,this.processParameters();case 37:null!==this.placeholder&&(this.element.placeholder=this.placeholder),this.disabled&&(this.twin.disabled=!0),void 0!==this.label&&(this.labelElement.textContent=this.label),this.element.addEventListener("input",(function(e){m.handleInput(e)})),this.element.addEventListener("keydown",(function(e){m.handleKeyAction(e)})),this.element.addEventListener("focusout",(function(e){m.handleFocusOut(e)})),this.element.addEventListener("wheel",(function(e){m.handleWheel(e)})),null!==(u=n.form)&&u.addEventListener("submit",(function(e){var t=m.checkValidity();return!1!==t.success||(e.preventDefault(),m.updateValidity(t,m.element),!1)}));case 46:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"returnSpecialButton",value:function(){if(null===this.buttonSettings)return!1;if("hint"===this.buttonSettings.type){if(void 0===this.buttonSettings.hintText)return console.warn('HaiForm: The "hint" type requires setting the "buttonSettings.hintText" property.'),!1;if("string"==typeof this.buttonSettings.hintText)return console.warn('HaiForm: The "buttonSettings.hintText" property must be of the string type.'),!1;var e=document.createElement("span");return e.innerHTML="",e}return!1}},{key:"processParameters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===e&&(e=this.parameters),s(i(d.prototype),"processParameters",this).call(this,e),void 0!==e.placeholder&&("string"!=typeof e.placeholder?console.warn('HaiForm: Parameter "placeholder" must be a string.'):this.placeholder=e.placeholder),void 0!==e.mask&&("string"!=typeof e.mask?console.warn('HaiForm: Parameter "mask" must be a string.'):this.mask=e.mask),void 0!==e.maxLength&&(!0===isNaN(e.maxLength)?console.warn('HaiForm: Parameter "maxLength" must be a number, reverting back to null.'):this.maxLength=e.maxLength),void 0!==e.minLength&&(!0===isNaN(e.minLength)?console.warn('HaiForm: Parameter "minLength" must be a number, reverting back to null.'):this.minLength=e.minLength),void 0!==e.maskTokens&&("object"!==l(e.maskTokens)?console.warn('HaiForm: Parameter "maskTokens" must be an object, reverting back to null.'):this.maskTokens=e.maskTokens)}},{key:"handleInput",value:function(e){if(this.readonly||this.disabled)return e.target.value=this.value,{success:!1};var t=e.target.value;return null!=this.mask&&(t=this.formatValueByMask(t)),this.value=t,this.rawValue=t,e.target.value=t,this.saveValueToTwin(),{success:!0}}},{key:"formatValueByMask",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===t&&(t=this.value),null===n&&(n=this.mask),e=null!==this.maskTokens?this.maskTokens:{0:{pattern:/\d/},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/},"!":{escape:!0},"?":{optional:!0}};for(var a=0,s=0,i=!0,l="",r=!1,h=!1,o="";a<t.length&&s<n.length;){var u=t[a],m=n[s],c=e[m];if(void 0!==c&&!0!==r)if(!0!==c.escape)if(!0!==c.optional){var d=c.pattern.test(u);if(!1===d&&!1===h){i=!1;break}!1!==d?(h=!1,o+=l,l="",void 0!==c.transform&&(u=c.transform(u)),o+=u,s++,a++):(h=!1,s++)}else h=!0,s++;else r=!0,s++;else{if(r=!1,String(m)===u){o+=l,l="",o+=u,s++,a++;continue}l+=m,s++}}return s<n.length&&(i=!1),this.validByMask=i,o}},{key:"checkValidity",value:function(){var e=s(i(d.prototype),"checkValidity",this).call(this);return!1===e.success?e:null!=this.maxLength&&this.value.length>this.maxLength?{success:!1,message:r.dictionary["max-length-exceeded"].replace("{{maxLength}}",this.maxLength)}:null!=this.minLength&&this.value.length<this.minLength?{success:!1,message:r.dictionary["min-length-exceeded"].replace("{{minLength}}",this.minLength)}:null!=this.mask&&(this.formatValueByMask(),""!==this.rawValue&&!1===this.validByMask)?{success:!1,message:r.dictionary["mask-not-followed"]}:{success:!0}}}]),d}();export{u as HaiInputText};
